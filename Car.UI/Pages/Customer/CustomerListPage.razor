@page "/customer/list"

@using Car.Shared
@using Car.UI.Services
@using Car.UI.Components
@inject ICustomerService CustomerService
@inject NavigationManager Navigation

<h3>Customer List</h3>

@if (Customers is null)
{
	<p>Loading..</p>
}
else
{
	<CustomerList Customers="Customers" ItemsPerPage="2" CurrentPageNumber="cPage" PageChanged="PageChanged"/>
}

@code {
	[SupplyParameterFromQuery(Name = "page")]
	[Parameter]
	public int? Page { get; set; }

	private int cPage => Page ?? 1;

	private IList<CustomerGetUpdateDTO>? Customers { get; set; }

	protected override async Task OnInitializedAsync()
	{
		Customers = await CustomerService.GetAllCustomersAsync();
	}

	private async Task PageChanged(int newPage)
	{
		Page = newPage;
		Navigation.NavigateTo(Navigation.GetUriWithQueryParameter("page", newPage));
	}
}
